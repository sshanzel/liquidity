# Debezium Server Configuration
# Uses environment variables for tenant-specific values

# Sink: Google Pub/Sub (emulator)
debezium.sink.type=pubsub
debezium.sink.pubsub.project.id=liquidity-local
debezium.sink.pubsub.ordering.enabled=true
debezium.sink.pubsub.address=pubsub:8085

# Source: PostgreSQL
debezium.source.connector.class=io.debezium.connector.postgresql.PostgresConnector
debezium.source.offset.storage.file.filename=/debezium/data/offsets.dat
debezium.source.offset.flush.interval.ms=0

# Database connection (uses env vars)
debezium.source.database.hostname=postgres
debezium.source.database.port=5432
debezium.source.database.user=liquidity
debezium.source.database.password=liquidity
debezium.source.database.dbname=${TENANT_DB}

# Connector settings (slot.name must be unique per instance)
debezium.source.topic.prefix=${TENANT_ID}
debezium.source.slot.name=debezium_${TENANT_DB}
debezium.source.table.include.list=public.report_contents
debezium.source.plugin.name=pgoutput
debezium.source.publication.autocreate.mode=filtered

# Schema history
debezium.source.schema.history.internal=io.debezium.storage.file.history.FileSchemaHistory
debezium.source.schema.history.internal.file.filename=/debezium/data/schema-history.dat

# Transforms: route all to single topic
debezium.transforms=Reroute
debezium.transforms.Reroute.type=io.debezium.transforms.ByLogicalTableRouter
debezium.transforms.Reroute.topic.regex=(.*)
debezium.transforms.Reroute.topic.replacement=tenant-cdc
